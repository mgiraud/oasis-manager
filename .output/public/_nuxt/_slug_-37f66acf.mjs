import{_ as E,d as x,a as S,u as h,x as w,p as y,aq as C,q as I,s as b,Q as D,ac as M,o as _,c as N,e as P,f as k,C as c,k as B}from"./entry-7a7af91b.mjs";import{u as O}from"./asyncData-189d8b04.mjs";import{F as U}from"./FormComponent-02143e6d.mjs";import"./Icon-b7f67c13.mjs";import"./useDateHelper-e4869b7b.mjs";import"./Editor-efecd958.mjs";import"./TextField-e0d4bdd8.mjs";import"./use-outside-click-17810f29.mjs";import"./use-resolve-button-type-229cdeb6.mjs";import"./dialog-b0bfe91c.mjs";import"./FileManager-0bb7eff3.mjs";import"./transition-82de0b1f.mjs";import"./CheckboxField-20f6aa23.mjs";const A=x({async setup(f,{expose:r}){r();let i,e;const t=S(),p=h(),u=w(),s=y("page-edition",()=>null),m=C();[i,e]=I(async()=>O("async-page-edition",async()=>{await t.load(p.params.slug,{"groups[]":"page:read:edition"}),s.value=t[c.EDITION].retrieved})),await i,e();const l=b(),v=async(o,n)=>{o.isPublished==="true"&&(o.isPublished=!1),o.showInMenu==="true"&&(o.showInMenu=!1);try{await t.update(o.url,o),l.showMessage("Page correctement \xE9dit\xE9e")}catch{l.showError("Erreur dans la sauvegarde la page, v\xE9rifie le formulaire"),n.setErrors(t[c.Edition].violations)}};let a=null;const d=()=>{var o,n;m.create({originalContent:(o=s.value)==null?void 0:o.content,draft:!0,page:(n=s.value)==null?void 0:n["@id"]})};D(()=>{a=window.setInterval(d,12e4)}),M(()=>{a&&clearInterval(a),a=null});const g={pageStore:t,route:p,app:u,pageEdition:s,pageLogStore:m,notificationStore:l,submit:v,autoSaveInterval:a,autoSave:d,FormComponent:U,CRUD_MODE:c};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),F={class:"flex flex-col flex-auto p-3"},R=B("h1",{class:"mb-4"},"\xC9dition d'une page",-1);function q(f,r,i,e,t,p){return _(),N("div",F,[R,e.pageEdition?(_(),P(e.FormComponent,{key:0,page:e.pageEdition,"onUpdate:page":r[0]||(r[0]=u=>e.pageEdition=u),"submit-handler":e.submit,errors:e.pageStore[e.CRUD_MODE.EDITION].violations},null,8,["page","errors"])):k("",!0)])}var $=E(A,[["render",q]]);export{$ as default};
